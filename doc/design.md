# 功能设计

## 预先准备

- 模型定义在models模块中
- 模型推理pipeline
- 模型训练pipeline

## 分解-优化阶段

### 总体流程

1. 确定被分解的模型；
2. 确定被分解的模块的位置；
3. 选择分解算法；
4. 遍历所有选择的模块，替换为新旧双分支；
5. 优化子阶段；
6. 删除旧分支，保存模型新参数；


### 优化子阶段

#### 数据无关的重建

对每一个被分解的层，用旧分支的参数监督优化新分支参数，使得重建误差最小；
优化算法通常与分解算法是强耦合的；

#### 数据相关的重建

换一种说法，就是在原来的数据集上逐层微调，支持添加/替换损失函数，冻结非分解层参数等；
仍然需要双分支的设计，并且在每次反向传播/优化迭代之前完成两个网络到该层的前向推理；

#### 分解后模型的加载

给定分解算法和参数，给定之前得到的检查点，在初始化时就完成分支的替换；


## 数据结构




